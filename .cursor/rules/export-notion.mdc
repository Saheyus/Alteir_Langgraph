# Export vers Notion - RÃ¨gles et Configuration

## ğŸš¨ **RÃˆGLE CRITIQUE : Utiliser UNIQUEMENT le Bac Ã  Sable**

### âŒ **NE JAMAIS crÃ©er dans les bases principales**
Jusqu'Ã  validation complÃ¨te du projet, **TOUTE CRÃ‰ATION** doit se faire dans le **bac Ã  sable**.

### âœ… **Bases de donnÃ©es Ã  utiliser**

#### **Bac Ã  Sable (Ã‰CRITURE AUTORISÃ‰E)**
- **Personnages (1)** : 
  - Database ID: `2806e4d21b458012a744d8d6723c8be1`
  - Data Source: `collection://2806e4d2-1b45-811b-b079-000bda28ed01`
  - Localisation: Page "Bac Ã  sable" (`2806e4d21b4580eab1a2def9831bdc80`)

- **Lieux (1)** :
  - Database ID: `2806e4d21b4580969f1cd7463a4c889c`
  - Localisation: Page "Bac Ã  sable"

#### **Bases Principales (LECTURE SEULE)**
- **Personnages** : `1886e4d21b4581a29340f77f5f2e5885` âš ï¸ **NE PAS Ã‰CRIRE**
- **Lieux** : `1886e4d21b4581eda022ea4e0f1aba5f` âš ï¸ **NE PAS Ã‰CRIRE**
- **CommunautÃ©s** : `1886e4d21b4581dea4f4d01beb5e1be2` âš ï¸ **NE PAS Ã‰CRIRE**
- **EspÃ¨ces** : `1886e4d21b4581e9a768df06185c1aea` âš ï¸ **NE PAS Ã‰CRIRE**
- **Objets** : `1886e4d21b4581098024c61acd801f52` âš ï¸ **NE PAS Ã‰CRIRE**

## ğŸ“‹ **Workflow de Validation**

### Phase 1 : DÃ©veloppement (ACTUEL)
1. âœ… GÃ©nÃ©rer le contenu avec les agents
2. âœ… Exporter vers **Bac Ã  Sable uniquement**
3. âœ… Tester et valider dans le bac Ã  sable
4. âœ… ItÃ©rer et amÃ©liorer

### Phase 2 : Validation (FUTURE)
1. â³ Valider la qualitÃ© des gÃ©nÃ©rations
2. â³ Tester les workflows complets
3. â³ Obtenir l'accord pour production

### Phase 3 : Production (APRÃˆS VALIDATION)
1. ğŸ”’ Modifier les IDs vers les bases principales
2. ğŸ”’ Activer l'Ã©criture en production
3. ğŸ”’ DÃ©ployer le systÃ¨me validÃ©

## ğŸ”§ **ImplÃ©mentation dans le Code**

### API REST Notion (app_streamlit.py)
```python
# BAC Ã€ SABLE - Ne pas modifier sans validation
DATABASE_ID = "2806e4d21b458012a744d8d6723c8be1"  # Personnages (1)

# PRODUCTION (dÃ©sactivÃ©)
# DATABASE_ID = "1886e4d21b4581a29340f77f5f2e5885"  # Personnages
```

### Outils MCP (pour l'IA)
```python
# CrÃ©er dans le bac Ã  sable
mcp_notionMCP_notion-create-pages(
    parent={"data_source_id": "2806e4d2-1b45-811b-b079-000bda28ed01"},  # Personnages (1)
    pages=[...]
)
```

## ğŸ“Š **Structure du Bac Ã  Sable**

### Page "Bac Ã  sable" (`2806e4d21b4580eab1a2def9831bdc80`)
```
ğŸ“„ Bac Ã  sable
  â”œâ”€â”€ ğŸ“Š Personnages (1)  [Database pour tests]
  â””â”€â”€ ğŸ“Š Lieux (1)        [Database pour tests]
```

### PropriÃ©tÃ©s identiques
Les databases du bac Ã  sable ont **exactement le mÃªme schÃ©ma** que les bases principales :
- MÃªme structure de colonnes
- MÃªmes propriÃ©tÃ©s (Type, Genre, Ã‰tat, etc.)
- MÃªmes relations possibles

## âš ï¸ **VÃ©rifications Avant Export**

### Checklist PrÃ©-Export
- [ ] Le DATABASE_ID pointe vers le **bac Ã  sable**
- [ ] Le token Notion est configurÃ© dans `.env`
- [ ] L'export affiche clairement "Bac Ã  sable" dans les logs
- [ ] Le lien gÃ©nÃ©rÃ© mÃ¨ne vers Personnages (1) et non Personnages

### En cas d'erreur
```python
# VÃ©rifier l'ID utilisÃ©
if DATABASE_ID == "1886e4d21b4581a29340f77f5f2e5885":
    raise ValueError("âŒ ERREUR: Ne pas crÃ©er dans la base principale!")
```

## ğŸ“ **Documentation des Exports**

### Message utilisateur
Toujours indiquer clairement Ã  l'utilisateur oÃ¹ la fiche a Ã©tÃ© crÃ©Ã©e :
```
âœ… Export rÃ©ussi
Le personnage Norrik a Ã©tÃ© crÃ©Ã© dans le bac Ã  sable Personnages (1)
ğŸ“„ Ouvrir la fiche dans Notion â†’
```

### Logs de debug
```python
st.info(f"""
**Informations de la page:**
- Base: Personnages (1) - BAC Ã€ SABLE âš ï¸
- ID: {page_id}
- Ã‰tat: Brouillon IA
""")
```

## ğŸ¯ **Objectif Final**

Une fois le projet validÃ© :
1. Changer tous les IDs vers les bases principales
2. Documenter le changement
3. Tester exhaustivement
4. DÃ©ployer en production

---

**RAPPEL IMPORTANT** : Tant que cette rÃ¨gle existe, **AUCUNE crÃ©ation** ne doit se faire dans les bases principales. Toujours utiliser le bac Ã  sable.

*DerniÃ¨re mise Ã  jour : 2 octobre 2025*
