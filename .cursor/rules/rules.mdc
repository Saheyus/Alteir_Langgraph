# RÃ¨gles et Conventions - SystÃ¨me Multi-Agents GDD Alteir

## ğŸ¯ Objectif du Projet
DÃ©velopper un systÃ¨me multi-agents local pour l'Ã©criture, la relecture et la correction du Game Design Document (GDD) stockÃ© dans Notion, utilisant LangGraph et les outils MCP.

## ğŸ—ï¸ Architecture Technique

### Framework Principal
- **LangGraph** : Framework de choix pour les graphes d'Ã©tat et workflows multi-agents
- **LangGraph Studio** : Interface locale via `langgraph dev` pour visualisation
- **MCP (Model Context Protocol)** : IntÃ©gration avec Notion et autres services

### ModÃ¨les IA
- **Principal** : GPT-5 (via OpenAI Responses API)
- **ParamÃ¨tres recommandÃ©s** :
  - `reasoning.effort = "minimal"` pour les tests
  - `verbosity = "low"` pour contrÃ´ler la longueur
  - `max_output_tokens` pour borner les coÃ»ts
- **ModÃ¨les locaux** : 20-30B paramÃ¨tres (optionnel)

## ğŸ¤– Agents SpÃ©cialisÃ©s

### Agent Ã‰crivain
- **RÃ´le** : CrÃ©ation de contenu pour les diffÃ©rentes sections du GDD
- **SpÃ©cialisations** : Personnages, Lieux, Chronologie, Objets, CommunautÃ©s
- **Sortie** : Contenu structurÃ© en format Notion Markdown

### Agent Relecteur
- **RÃ´le** : VÃ©rification de la cohÃ©rence narrative et structurelle
- **ResponsabilitÃ©s** :
  - Validation des liens entre Ã©lÃ©ments
  - ContrÃ´le de la cohÃ©rence du lore
  - VÃ©rification de la structure des sections

### Agent Correcteur
- **RÃ´le** : Correction linguistique et amÃ©lioration du style
- **ResponsabilitÃ©s** :
  - Correction orthographique et grammaticale
  - AmÃ©lioration de la clartÃ© et du style
  - Respect des conventions d'Ã©criture

### Agent Validateur
- **RÃ´le** : Validation finale et contrÃ´le qualitÃ©
- **ResponsabilitÃ©s** :
  - VÃ©rification des rÃ©fÃ©rences croisÃ©es
  - Validation des donnÃ©es structurÃ©es
  - ContrÃ´le de la complÃ©tude

## ğŸ“Š IntÃ©gration Notion

### Bases de DonnÃ©es Principales
- **Lieux** : `1886e4d21b4581eda022ea4e0f1aba5f`
- **Personnages** : `1886e4d21b4581a29340f77f5f2e5885`
- **CommunautÃ©s** : `1886e4d21b4581dea4f4d01beb5e1be2`
- **EspÃ¨ces** : `1886e4d21b4581e9a768df06185c1aea`
- **Objets** : `1886e4d21b4581098024c61acd801f52`
- **Chronologie d'Escelion** : `22c6e4d21b458066b17cc2af998de0b8`

### MÃ©thode de RÃ©cupÃ©ration des DonnÃ©es
1. **Fetch de la base** : `mcp_notionMCP_fetch` avec l'ID de la base
2. **Search sur data_source** : `mcp_notionMCP_search` avec le `data_source_url`
3. **Filtrage** : CÃ´tÃ© client aprÃ¨s rÃ©cupÃ©ration complÃ¨te

## ğŸ’» Conventions de Code

### Structure des Fichiers
```
/
â”œâ”€â”€ agents/           # Agents spÃ©cialisÃ©s
â”œâ”€â”€ workflows/        # DÃ©finitions des workflows
â”œâ”€â”€ utils/           # Utilitaires et helpers
â”œâ”€â”€ config/          # Configuration et paramÃ¨tres
â”œâ”€â”€ tests/           # Tests unitaires et d'intÃ©gration
â””â”€â”€ docs/            # Documentation
```

### Conventions Python
- **Type hints** : Obligatoires pour toutes les fonctions
- **Docstrings** : Format Google pour toutes les fonctions publiques
- **Nommage** : snake_case pour variables/fonctions, PascalCase pour classes
- **Imports** : TriÃ©s et groupÃ©s (standard, tiers, local)

### Gestion des Ã‰tats
- **Classe DocState** : Ã‰tat partagÃ© entre agents
- **Normalisation** : Fonction `to_text()` pour uniformiser les contenus
- **SÃ©rialisation** : Support JSON pour persistance

## ğŸ”§ Configuration et Environnement

### Variables d'Environnement
```bash
OPENAI_API_KEY=your_key_here
NOTION_TOKEN=your_notion_token
LANGGRAPH_API_KEY=optional_for_studio
```

### DÃ©pendances Principales
- `langgraph` : Framework multi-agents
- `langchain-openai` : IntÃ©gration OpenAI
- `mcp` : Protocole de contexte modÃ¨le
- `python-dotenv` : Gestion des variables d'environnement

## ğŸš€ Workflows

### Workflow Standard (Ã‰criture â†’ Relecture â†’ Correction)
1. **Agent Ã‰crivain** : GÃ©nÃ¨re le contenu initial
2. **Agent Relecteur** : VÃ©rifie la cohÃ©rence
3. **Agent Correcteur** : AmÃ©liore la forme
4. **Agent Validateur** : Validation finale

### Workflows SpÃ©cialisÃ©s
- **CrÃ©ation de personnage** : Ã‰criture â†’ Validation des liens â†’ Correction
- **Mise Ã  jour de chronologie** : Relecture â†’ Validation des dates â†’ Correction
- **Ajout de lieu** : Ã‰criture â†’ Validation gÃ©ographique â†’ Correction

## ğŸ§ª Tests et Validation

### Tests Unitaires
- Chaque agent doit avoir ses tests
- Tests des workflows complets
- Tests d'intÃ©gration MCP

### Validation des RÃ©sultats
- Comparaison avec contenu existant
- VÃ©rification de la cohÃ©rence narrative
- ContrÃ´le qualitÃ© linguistique

## ğŸ“ Documentation

### Documentation du Code
- Docstrings complÃ¨tes
- Exemples d'utilisation
- Guide de contribution

### Documentation Utilisateur
- Guide d'installation
- Tutoriel d'utilisation
- FAQ et dÃ©pannage

## ğŸ”’ SÃ©curitÃ© et Bonnes Pratiques

### Gestion des ClÃ©s API
- Variables d'environnement uniquement
- Pas de clÃ©s en dur dans le code
- Rotation rÃ©guliÃ¨re des tokens

### Validation des EntrÃ©es
- Sanitisation des inputs utilisateur
- Validation des formats de donnÃ©es
- Gestion des erreurs MCP

## ğŸ“ˆ Optimisation et Performance

### CoÃ»ts OpenAI
- Utilisation de `max_output_tokens`
- ParamÃ¨tres `reasoning.effort` adaptÃ©s
- Cache des rÃ©ponses identiques

### Performance Locale
- ParallÃ©lisation des agents quand possible
- Optimisation des appels MCP
- Gestion de la mÃ©moire

---

*DerniÃ¨re mise Ã  jour : Janvier 2025*
*Version : 1.0*